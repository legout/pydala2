# Advanced Querying

This example demonstrates advanced querying capabilities in PyDala2, including complex filtering, SQL integration, and performance optimization techniques.

## What You'll Learn

- Complex filtering and predicates
- SQL integration with DuckDB
- Window functions and aggregations
- Multi-dataset queries
- Performance optimization techniques
- Advanced analytics and insights

## Files

- `advanced_querying.py` - Python script demonstrating advanced querying operations
- `advanced_querying.ipynb` - Jupyter notebook version
- `advanced_querying.marimo.py` - Marimo notebook version

## Running the Examples

### Python Script
```bash
cd advanced-querying
python advanced_querying.py
```

### Jupyter Notebook
```bash
cd advanced-querying
jupyter notebook advanced_querying.ipynb
```

### Marimo Notebook
```bash
cd advanced-querying
marimo edit advanced_querying.marimo.py
```

## Prerequisites

- PyDala2 installed (`pip install pydala2`)
- DuckDB for SQL integration (`pip install duckdb`)
- Sample data will be generated by the examples

## Key Concepts Demonstrated

1. **Complex Filtering**: Multi-condition filters, date ranges, string operations
2. **SQL Integration**: DuckDB integration for powerful SQL queries
3. **Advanced Aggregations**: Multi-level grouping, pivot tables, rolling calculations
4. **Performance Optimization**: Column pruning, partition pruning, efficient scanning
5. **Multi-Dataset Queries**: Joins, cross-dataset analysis, relational operations
6. **Advanced Analytics**: Customer analytics, product performance, market basket analysis

## Advanced Topics

- Window functions and analytical queries
- Time series analysis and seasonal patterns
- Geographic and demographic analysis
- Customer lifetime value calculations
- Market basket analysis and product associations
- Performance optimization for large datasets

## Next Steps

After mastering advanced querying, explore:
- Performance Optimization examples
- Cloud Storage integration
- Time Series analysis
- Metadata Management techniques

## Dataset Schema

The examples use realistic sales data with the following structure:

**Sales Data:**
- `sale_id`: Unique sale identifier
- `customer_id`: Customer identifier
- `product_id`: Product identifier
- `sale_date`: Date of sale
- `sale_amount`: Sale amount before discount
- `quantity`: Number of items
- `discount_percent`: Discount percentage
- `payment_method`: Payment method
- `region`: Geographic region
- `customer_segment`: Customer segment (Premium/Standard/Basic)

**Product Data:**
- `product_id`: Unique product identifier
- `product_name`: Product name
- `category`: Product category
- `base_price`: Standard price
- `cost`: Product cost

**Customer Data:**
- `customer_id`: Unique customer identifier
- `age`: Customer age
- `city`: Customer city
- `state`: Customer state
- `registration_date`: Customer registration date